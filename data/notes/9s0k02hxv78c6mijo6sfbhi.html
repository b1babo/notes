<h1 id="docker"><a aria-hidden="true" class="anchor-heading icon-link" href="#docker"></a>Docker</h1>
<h2 id="dockerinstall"><a aria-hidden="true" class="anchor-heading icon-link" href="#dockerinstall"></a>docker install</h2>
<pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> pacman -Ss <span class="token function">docker</span> 
</code></pre>
<h2 id="dockerstart"><a aria-hidden="true" class="anchor-heading icon-link" href="#dockerstart"></a>docker start</h2>
<p>启动</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> systemctl  start <span class="token function">docker</span>
</code></pre>
<p>把用户加入docker用户组，无需每次输入sudo</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">usermod</span> -aG <span class="token function">docker</span> <span class="token environment constant">$USER</span>
<span class="token comment"># 需要 logout 重新登录</span>
</code></pre>
<h2 id="设置国内源"><a aria-hidden="true" class="anchor-heading icon-link" href="#设置国内源"></a>设置国内源</h2>
<p>新建或编辑daemon.json</p>
<pre class="language-bash"><code class="language-bash"><span class="token function">vi</span> /etc/docker/daemon.json
</code></pre>
<p>在daemon.json中编辑如下</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>

 <span class="token property">"registry-mirrors"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"http://hub-mirror.c.163.com"</span><span class="token punctuation">]</span>

<span class="token punctuation">}</span>
</code></pre>
<p>国内源</p>
<pre><code>网易
http://hub-mirror.c.163.com
Docker中国区官方镜像
https://registry.docker-cn.com
中国科技大学
https://docker.mirrors.ustc.edu.cn
</code></pre>
<h2 id="dockerimage"><a aria-hidden="true" class="anchor-heading icon-link" href="#dockerimage"></a>docker image</h2>
<p>文件生成的容器实例，本身也是一个文件，称为容器文件。也就是说，一旦容器生成，就会同时存在两个文件： image 文件和容器文件。而且关闭容器并不会删除容器文件，只是容器停止运行而已。把应用程序及其依赖，打包在 image 文件里面。只有通过这个文件，才能生成 Docker 容器。image 文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。同一个 image 文件，可以生成多个同时运行的容器实例。</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># 列出本机的所有 image 文件。</span>
<span class="token function">docker</span> image <span class="token function">ls</span>
<span class="token comment"># 删除 image 文件</span>
<span class="token function">docker</span> image <span class="token function">rm</span> <span class="token punctuation">[</span>imageName<span class="token punctuation">]</span>
<span class="token comment">#搜索 镜像</span>
<span class="token function">docker</span> search <span class="token punctuation">[</span>imageName<span class="token punctuation">]</span>
<span class="token comment"># 拉取 image 文件</span>
<span class="token function">docker</span> image pull <span class="token punctuation">[</span>imageName<span class="token punctuation">]</span>
</code></pre>
<h2 id="dockercontainer"><a aria-hidden="true" class="anchor-heading icon-link" href="#dockercontainer"></a>docker container</h2>
<h4 id="运行容器"><a aria-hidden="true" class="anchor-heading icon-link" href="#运行容器"></a>运行容器</h4>
<pre class="language-bash"><code class="language-bash"><span class="token function">docker</span> container run ubuntu /bin/bash
<span class="token comment"># 参数</span>
-i: 交互式操作。
-t: 终端。
-d: 后台运行，需要通过exec进入容器
-p: 如 <span class="token number">8000</span>:3000 容器的3000映射到本机的8000端口，默认是tcp，后面添加/udp绑定udp端口



<span class="token comment">#进入运行中的容器</span>
<span class="token function">sudo</span> <span class="token function">docker</span> <span class="token builtin class-name">exec</span> -it <span class="token punctuation">[</span>containerId<span class="token punctuation">]</span> /bin/bash  

<span class="token comment"># 列出本机正在运行的容器</span>
<span class="token function">docker</span> container <span class="token function">ls</span>
<span class="token function">docker</span> <span class="token function">ps</span> -a 
<span class="token comment"># 列出本机所有容器，包括终止运行的容器</span>
<span class="token function">docker</span> container <span class="token function">ls</span> --all
<span class="token comment"># 启动/停止 容器</span>
<span class="token function">docker</span> start/stop <span class="token punctuation">[</span>containerId<span class="token punctuation">]</span>
<span class="token comment"># 终止 容器</span>
<span class="token function">docker</span> container <span class="token function">kill</span> <span class="token punctuation">[</span>containerId<span class="token punctuation">]</span>
<span class="token comment"># 删除 容器</span>
<span class="token function">docker</span> container <span class="token function">rm</span> <span class="token punctuation">[</span>containerId<span class="token punctuation">]</span>
</code></pre>
<h3 id="镜像导出导入"><a aria-hidden="true" class="anchor-heading icon-link" href="#镜像导出导入"></a>镜像导出导入</h3>
<pre class="language-bash"><code class="language-bash"><span class="token comment">### 将本地的镜像导出</span>
<span class="token function">docker</span> save -o 导出的路径 镜像id/镜像名称:tag
<span class="token comment">#e.g.</span>
<span class="token function">docker</span> save -o ./ubuntu.image ubuntu:16.04
 
<span class="token comment">### 加载本地的镜像文件</span>
<span class="token function">docker</span> load -i 镜像文件
<span class="token comment"># e.g.</span>
<span class="token function">docker</span> load -i ubuntu.image
</code></pre>
<h2 id="参考"><a aria-hidden="true" class="anchor-heading icon-link" href="#参考"></a>参考</h2>
<p><a href="https://juejin.cn/post/6844903976534540296">Docker Compose 网络设置 - 掘金 (juejin.cn)</a></p>