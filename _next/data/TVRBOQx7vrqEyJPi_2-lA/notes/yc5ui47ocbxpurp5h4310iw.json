{"pageProps":{"note":{"id":"yc5ui47ocbxpurp5h4310iw","title":"Program Misuse","desc":"","updated":1669076410724,"created":1669076357635,"custom":{},"fname":"computer.security.pwn-college.program-misuse","type":"note","vault":{"fsPath":".","selfContained":true,"name":"dendron-note"},"contentHash":"09f6ca3243eb5be8b2ae2da749d6b389","links":[],"anchors":{"challenges":{"type":"header","text":"Challenges","value":"challenges","line":10,"column":0,"depth":2},"如何开始做题":{"type":"header","text":"如何开始做题","value":"如何开始做题","line":12,"column":0,"depth":3},"解题思路":{"type":"header","text":"解题思路","value":"解题思路","line":16,"column":0,"depth":3},"babysuid-level1":{"type":"header","text":"babysuid-level1","value":"babysuid-level1","line":20,"column":0,"depth":3},"babysuid-level2":{"type":"header","text":"babysuid-level2","value":"babysuid-level2","line":26,"column":0,"depth":3},"babysuid-level3":{"type":"header","text":"babysuid-level3","value":"babysuid-level3","line":33,"column":0,"depth":3},"babysuid-level4":{"type":"header","text":"babysuid-level4","value":"babysuid-level4","line":39,"column":0,"depth":3},"babysuid-level5":{"type":"header","text":"babysuid-level5","value":"babysuid-level5","line":45,"column":0,"depth":3},"babysuid-level6":{"type":"header","text":"babysuid-level6","value":"babysuid-level6","line":52,"column":0,"depth":3},"babysuid-level7":{"type":"header","text":"babysuid-level7","value":"babysuid-level7","line":59,"column":0,"depth":3},"babysuid-level8":{"type":"header","text":"babysuid-level8","value":"babysuid-level8","line":66,"column":0,"depth":3},"babysuid-level9":{"type":"header","text":"babysuid-level9","value":"babysuid-level9","line":73,"column":0,"depth":3},"babysuid-level10":{"type":"header","text":"babysuid-level10","value":"babysuid-level10","line":80,"column":0,"depth":3},"babysuid-level11":{"type":"header","text":"babysuid-level11","value":"babysuid-level11","line":87,"column":0,"depth":3},"babysuid-level12":{"type":"header","text":"babysuid-level12","value":"babysuid-level12","line":110,"column":0,"depth":3},"babysuid-level13":{"type":"header","text":"babysuid-level13","value":"babysuid-level13","line":121,"column":0,"depth":3},"babysuid-level14":{"type":"header","text":"babysuid-level14","value":"babysuid-level14","line":132,"column":0,"depth":3},"babysuid-level15":{"type":"header","text":"babysuid-level15","value":"babysuid-level15","line":139,"column":0,"depth":3},"babysuid-level16":{"type":"header","text":"babysuid-level16","value":"babysuid-level16","line":146,"column":0,"depth":3},"babysuid-level17":{"type":"header","text":"babysuid-level17","value":"babysuid-level17","line":155,"column":0,"depth":3},"babysuid-level18":{"type":"header","text":"babysuid-level18","value":"babysuid-level18","line":165,"column":0,"depth":3},"babysuid-level19":{"type":"header","text":"babysuid-level19","value":"babysuid-level19","line":174,"column":0,"depth":3},"babysuid-level20":{"type":"header","text":"babysuid-level20","value":"babysuid-level20","line":187,"column":0,"depth":3}},"children":[],"parent":"at8lgpuamaaz90dxra5ka5p","data":{}},"body":"<h1 id=\"program-misuse\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#program-misuse\"></a>Program Misuse</h1>\n<h2 id=\"challenges\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#challenges\"></a>Challenges</h2>\n<h3 id=\"如何开始做题\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#如何开始做题\"></a>如何开始做题</h3>\n<pre class=\"language-sh\"><code class=\"language-sh\">/challenge/babysuid_level1\n</code></pre>\n<h3 id=\"解题思路\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#解题思路\"></a>解题思路</h3>\n<p>根据这个章节的名字可知：程序的错误使用，某个可执行程序（通常为系统中常见的程序）被设置了suid位，设置了suid位的程序能够以该程序所有者的权限执行程序，因此如果程序所有者为root则能够以root权限执行，可完成提权，读取root文件等操作</p>\n<h3 id=\"babysuid-level1\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level1\"></a>babysuid-level1</h3>\n<p><code>/usr/bin/cat</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">cat /flag\n# pwn.college{IIrsGeCfQOMDxkMJjv325KWhdRR.QXzQTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level2\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level2\"></a>babysuid-level2</h3>\n<p><code>/usr/bin/more</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">more /flag\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level3\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level3\"></a>babysuid-level3</h3>\n<p><code>/usr/bin/less</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">less /flag\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level4\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level4\"></a>babysuid-level4</h3>\n<p><code>/usr/bin/tail</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">tail /flag\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level5\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level5\"></a>babysuid-level5</h3>\n<p><code>/usr/bin/head</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">head /flag\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level6\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level6\"></a>babysuid-level6</h3>\n<p><code>/usr/bin/sort</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">sort /flag\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level7\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level7\"></a>babysuid-level7</h3>\n<p><code>/usr/bin/vim</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">vim /flag\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level8\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level8\"></a>babysuid-level8</h3>\n<p><code>/usr/bin/emacs</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">emacs /flag\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level9\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level9\"></a>babysuid-level9</h3>\n<p><code>/usr/bin/nano</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">nano /flag\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level10\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level10\"></a>babysuid-level10</h3>\n<p><code>/usr/bin/rev</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">rev /flag | rev\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level11\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level11\"></a>babysuid-level11</h3>\n<p><code>/usr/bin/od</code>被设置suid</p>\n<p>打印八进制数，需要</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">od /flag\n\n0000000  30576  11886  28515  27756  26469  31589  28267  27719\n0000020  22099  21361  24936  29287  27467  13363  27714  25929\n0000040  25680  20022  26188  11861  22609  21882  19796  20851\n0000060  19780  19833  22394   2685\n0000070\n</code></pre>\n<p>打印字符，是否可以写入文件</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">od /flag -c\n0000000   p   w   n   .   c   o   l   l   e   g   e   {   k   n   G   l\n0000020   S   V   q   S   h   a   g   r   K   k   3   4   B   l   I   e\n0000040   P   d   6   N   L   f   U   .   Q   X   z   U   T   M   s   Q\n0000060   D   M   y   M   z   W   }  \\n\n0000070\n</code></pre>\n<h3 id=\"babysuid-level12\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level12\"></a>babysuid-level12</h3>\n<p><code>/usr/bin/hd</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">hd /flag \n00000000  70 77 6e 2e 63 6f 6c 6c  65 67 65 7b 6b 56 69 61  |pwn.college{kVia|\n00000010  44 61 51 41 57 51 70 62  66 51 68 6e 66 47 6e 77  |DaQAWQpbfQhnfGnw|\n00000020  64 47 30 75 73 4a 67 2e  51 58 30 55 54 4d 73 51  |dG0usJg.QX0UTMsQ|\n00000030  44 4d 79 4d 7a 57 7d 0a                           |DMyMzW}.|\n00000038\n</code></pre>\n<h3 id=\"babysuid-level13\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level13\"></a>babysuid-level13</h3>\n<p><code>/usr/bin/xxd</code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">xxd /flag \n00000000: 7077 6e2e 636f 6c6c 6567 657b 5144 5548  pwn.college{QDUH\n00000010: 6f31 6970 7761 6f7a 2d71 5730 3461 5133  o1ipwaoz-qW04aQ3\n00000020: 6844 466a 795a 6c2e 5158 3155 544d 7351  hDFjyZl.QX1UTMsQ\n00000030: 444d 794d 7a57 7d0a                      DMyMzW}.\n</code></pre>\n<h3 id=\"babysuid-level14\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level14\"></a>babysuid-level14</h3>\n<p><code>/usr/bin/base32 </code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">base32 /flag | base32 -d\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level15\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level15\"></a>babysuid-level15</h3>\n<p><code>/usr/bin/base64 </code>被设置suid</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">base64 /flag | base64 -d\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level16\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level16\"></a>babysuid-level16</h3>\n<p><code>/usr/bin/split </code>被设置suid\n<code>split</code>可将文件分割，默认分割名字前缀为<code>x</code>则分割后文件名为<code>xaa xab</code></p>\n<pre class=\"language-sh\"><code class=\"language-sh\">split /flag \ncat /xaa\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level17\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level17\"></a>babysuid-level17</h3>\n<p><code>/usr/bin/gzip </code></p>\n<pre class=\"language-sh\"><code class=\"language-sh\">gzip /flag\n# flag.gz 仍是root只可读\ngzip /flag.gz -d -c\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level18\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level18\"></a>babysuid-level18</h3>\n<p><code>/usr/bin/bzip2 </code></p>\n<pre class=\"language-sh\"><code class=\"language-sh\">bzip2 -z /flag\n# flag.bz2 仍是root只可读\nbzip2 -d -c /flag\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level19\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level19\"></a>babysuid-level19</h3>\n<p><code>/usr/bin/zip </code>是否改成其他用户可读</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">zip z /flag.zip\n#-rw-r--r-- 1 root hacker 214 Nov  9 00:16 /z.zip\n# z.zip hacker可读\nunzip /z.zip\n# 将z.zip解压到hacker目录，其中的文件flag hacker可读\n#r-------- 1 hacker hacker 56 Nov  9 00:08 flag\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>\n<h3 id=\"babysuid-level20\"><a aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#babysuid-level20\"></a>babysuid-level20</h3>\n<p><code>/usr/bin/tar </code>是否改成其他用户可读</p>\n<pre class=\"language-sh\"><code class=\"language-sh\">zip z /flag.zip\n#-rw-r--r-- 1 root hacker 214 Nov  9 00:16 /z.zip\n# z.zip hacker可读\nunzip /z.zip\n# 将z.zip解压到hacker目录，其中的文件flag hacker可读\n#r-------- 1 hacker hacker 56 Nov  9 00:08 flag\n# pwn.college{o5x4cvHAO69UaaXWS48P_uWzcN1.QX0QTMsQDMyMzW}\n</code></pre>","noteIndex":{"id":"ua6fcc7oj4utcqkv8dhmcb8","title":"b1babo's note","desc":"","updated":1669076632533,"created":1668950311250,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"dendron-note"},"contentHash":"15dbb1bbcda17b2620bd900a3c14c525","links":[],"anchors":{},"children":["z6zdce798dlnm1qvlbj0147","u92paxy6iqch8vik9v6f4gm"],"parent":null,"data":{},"body":"\nwrite and record something.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"dendron-note"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enableHandlebarTemplates":true,"enableSmartRefs":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableMermaid":true},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","siteUrl":"https://b1babo.github.io","enableBackLinks":true,"assetsPrefix":"/notes","enableHierarchyDisplay":true,"enableMermaid":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true}